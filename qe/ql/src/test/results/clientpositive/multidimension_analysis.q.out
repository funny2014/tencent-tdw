query: DROP TABLE datatest
query: CREATE TABLE datatest(int_data1 INT, int_data2 INT, boolean_data BOOLEAN, double_data DOUBLE, string_data STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
query: LOAD DATA LOCAL INPATH '../data/files/datatest.txt' INTO TABLE datatest
query: select sum(double_data), grouping(INT_DATA1*2+1), 10*(int_data2+5),grouping(int_data2), grouping(string_data), grouping(boolean_data),boolean_data from datatest group by CUBE(int_data2,string_data),ROLLUP(int_data1*2+1),CUBE(GROUP(boolean_data,string_data))
Output: file:/data/tdwadmin/testroach/QE050/qe/build/ql/tmp/1424669017/10000
448.0737353856487	1	NULL	1	1	1	NULL
77.366359222852	1	50	0	1	1	NULL
67.02090558329242	1	60	0	1	1	NULL
79.7383767983528	1	70	0	1	1	NULL
13.944409118256818	1	80	0	1	1	NULL
59.704667583444426	1	90	0	1	1	NULL
112.76553639903352	1	100	0	1	1	NULL
14.998223744245005	1	120	0	1	1	NULL
5.621675730832165	1	130	0	1	1	NULL
16.91358120533963	1	140	0	1	1	NULL
2.2957055987034902	1	NULL	1	0	1	NULL
41.33606448637874	1	NULL	1	0	1	NULL
9.589949434284112	1	NULL	1	0	1	NULL
32.92404678679056	1	NULL	1	0	1	NULL
32.91569954365889	1	NULL	1	0	1	NULL
39.845454645318426	1	NULL	1	0	1	NULL
3.1145951928143676	1	NULL	1	0	1	NULL
20.494577702885913	1	NULL	1	0	1	NULL
19.754128235118877	1	NULL	1	0	1	NULL
41.39006188846539	1	NULL	1	0	1	NULL
22.086276366177614	1	NULL	1	0	1	NULL
69.07976891186463	1	NULL	1	0	1	NULL
48.72225330574438	1	NULL	1	0	1	NULL
19.398344450148464	1	NULL	1	0	1	NULL
14.998223744245005	1	NULL	1	0	1	NULL
24.506909362217737	1	NULL	1	0	1	NULL
5.621675730832165	1	NULL	1	0	1	NULL
41.33606448637874	1	50	0	0	1	NULL
32.91569954365889	1	50	0	0	1	NULL
3.1145951928143676	1	50	0	0	1	NULL
9.589949434284112	1	60	0	0	1	NULL
32.92404678679056	1	60	0	0	1	NULL
24.506909362217737	1	60	0	0	1	NULL
39.845454645318426	1	70	0	0	1	NULL
20.494577702885913	1	70	0	0	1	NULL
19.398344450148464	1	70	0	0	1	NULL
5.1726951608379865	1	80	0	0	1	NULL
8.77171395741883	1	80	0	0	1	NULL
19.754128235118877	1	90	0	0	1	NULL
39.95053934832555	1	90	0	0	1	NULL
2.2957055987034902	1	100	0	0	1	NULL
41.39006188846539	1	100	0	0	1	NULL
69.07976891186463	1	100	0	0	1	NULL
14.998223744245005	1	120	0	0	1	NULL
5.621675730832165	1	130	0	0	1	NULL
16.91358120533963	1	140	0	0	1	NULL
167.75293192483156	0	NULL	1	1	1	NULL
171.39792016741916	0	NULL	1	1	1	NULL
108.92288329339806	0	NULL	1	1	1	NULL
41.33606448637874	0	50	0	1	1	NULL
3.1145951928143676	0	50	0	1	1	NULL
32.91569954365889	0	50	0	1	1	NULL
57.430956149008296	0	60	0	1	1	NULL
9.589949434284112	0	60	0	1	1	NULL
59.24379909546689	0	70	0	1	1	NULL
20.494577702885913	0	70	0	1	1	NULL
5.1726951608379865	0	80	0	1	1	NULL
8.77171395741883	0	80	0	1	1	NULL
59.704667583444426	0	90	0	1	1	NULL
2.2957055987034902	0	100	0	1	1	NULL
88.31711188942472	0	100	0	1	1	NULL
22.15271891090531	0	100	0	1	1	NULL
14.998223744245005	0	120	0	1	1	NULL
5.621675730832165	0	130	0	1	1	NULL
16.91358120533963	0	140	0	1	1	NULL
2.2957055987034902	0	NULL	1	0	1	NULL
41.33606448637874	0	NULL	1	0	1	NULL
9.589949434284112	0	NULL	1	0	1	NULL
32.92404678679056	0	NULL	1	0	1	NULL
32.91569954365889	0	NULL	1	0	1	NULL
39.845454645318426	0	NULL	1	0	1	NULL
3.1145951928143676	0	NULL	1	0	1	NULL
20.494577702885913	0	NULL	1	0	1	NULL
19.754128235118877	0	NULL	1	0	1	NULL
41.39006188846539	0	NULL	1	0	1	NULL
5.1726951608379865	0	NULL	1	0	1	NULL
16.91358120533963	0	NULL	1	0	1	NULL
46.927050000959326	0	NULL	1	0	1	NULL
22.15271891090531	0	NULL	1	0	1	NULL
39.95053934832555	0	NULL	1	0	1	NULL
8.77171395741883	0	NULL	1	0	1	NULL
19.398344450148464	0	NULL	1	0	1	NULL
14.998223744245005	0	NULL	1	0	1	NULL
24.506909362217737	0	NULL	1	0	1	NULL
5.621675730832165	0	NULL	1	0	1	NULL
41.33606448637874	0	50	0	0	1	NULL
32.91569954365889	0	50	0	0	1	NULL
3.1145951928143676	0	50	0	0	1	NULL
9.589949434284112	0	60	0	0	1	NULL
32.92404678679056	0	60	0	0	1	NULL
24.506909362217737	0	60	0	0	1	NULL
39.845454645318426	0	70	0	0	1	NULL
20.494577702885913	0	70	0	0	1	NULL
19.398344450148464	0	70	0	0	1	NULL
5.1726951608379865	0	80	0	0	1	NULL
8.77171395741883	0	80	0	0	1	NULL
19.754128235118877	0	90	0	0	1	NULL
39.95053934832555	0	90	0	0	1	NULL
2.2957055987034902	0	100	0	0	1	NULL
41.39006188846539	0	100	0	0	1	NULL
46.927050000959326	0	100	0	0	1	NULL
22.15271891090531	0	100	0	0	1	NULL
14.998223744245005	0	120	0	0	1	NULL
5.621675730832165	0	130	0	0	1	NULL
16.91358120533963	0	140	0	0	1	NULL
2.2957055987034902	1	NULL	1	0	0	false
41.33606448637874	1	NULL	1	0	0	false
9.589949434284112	1	NULL	1	0	0	true
32.92404678679056	1	NULL	1	0	0	false
32.91569954365889	1	NULL	1	0	0	true
39.845454645318426	1	NULL	1	0	0	false
3.1145951928143676	1	NULL	1	0	0	false
20.494577702885913	1	NULL	1	0	0	false
19.754128235118877	1	NULL	1	0	0	true
41.39006188846539	1	NULL	1	0	0	true
5.1726951608379865	1	NULL	1	0	0	false
16.91358120533963	1	NULL	1	0	0	true
69.07976891186463	1	NULL	1	0	0	true
48.72225330574438	1	NULL	1	0	0	true
19.398344450148464	1	NULL	1	0	0	true
14.998223744245005	1	NULL	1	0	0	false
24.506909362217737	1	NULL	1	0	0	true
5.621675730832165	1	NULL	1	0	0	true
41.33606448637874	1	50	0	0	0	false
32.91569954365889	1	50	0	0	0	true
3.1145951928143676	1	50	0	0	0	false
9.589949434284112	1	60	0	0	0	true
32.92404678679056	1	60	0	0	0	false
24.506909362217737	1	60	0	0	0	true
39.845454645318426	1	70	0	0	0	false
20.494577702885913	1	70	0	0	0	false
19.398344450148464	1	70	0	0	0	true
5.1726951608379865	1	80	0	0	0	false
8.77171395741883	1	80	0	0	0	true
19.754128235118877	1	90	0	0	0	true
39.95053934832555	1	90	0	0	0	true
2.2957055987034902	1	100	0	0	0	false
41.39006188846539	1	100	0	0	0	true
69.07976891186463	1	100	0	0	0	true
14.998223744245005	1	120	0	0	0	false
5.621675730832165	1	130	0	0	0	true
16.91358120533963	1	140	0	0	0	true
2.2957055987034902	1	NULL	1	0	0	false
41.33606448637874	1	NULL	1	0	0	false
9.589949434284112	1	NULL	1	0	0	true
32.92404678679056	1	NULL	1	0	0	false
32.91569954365889	1	NULL	1	0	0	true
39.845454645318426	1	NULL	1	0	0	false
3.1145951928143676	1	NULL	1	0	0	false
20.494577702885913	1	NULL	1	0	0	false
19.754128235118877	1	NULL	1	0	0	true
41.39006188846539	1	NULL	1	0	0	true
5.1726951608379865	1	NULL	1	0	0	false
16.91358120533963	1	NULL	1	0	0	true
69.07976891186463	1	NULL	1	0	0	true
48.72225330574438	1	NULL	1	0	0	true
19.398344450148464	1	NULL	1	0	0	true
14.998223744245005	1	NULL	1	0	0	false
24.506909362217737	1	NULL	1	0	0	true
5.621675730832165	1	NULL	1	0	0	true
41.33606448637874	1	50	0	0	0	false
32.91569954365889	1	50	0	0	0	true
3.1145951928143676	1	50	0	0	0	false
9.589949434284112	1	60	0	0	0	true
32.92404678679056	1	60	0	0	0	false
24.506909362217737	1	60	0	0	0	true
39.845454645318426	1	70	0	0	0	false
20.494577702885913	1	70	0	0	0	false
19.398344450148464	1	70	0	0	0	true
5.1726951608379865	1	80	0	0	0	false
8.77171395741883	1	80	0	0	0	true
19.754128235118877	1	90	0	0	0	true
39.95053934832555	1	90	0	0	0	true
2.2957055987034902	1	100	0	0	0	false
41.39006188846539	1	100	0	0	0	true
69.07976891186463	1	100	0	0	0	true
14.998223744245005	1	120	0	0	0	false
5.621675730832165	1	130	0	0	0	true
16.91358120533963	1	140	0	0	0	true
2.2957055987034902	0	NULL	1	0	0	false
41.33606448637874	0	NULL	1	0	0	false
9.589949434284112	0	NULL	1	0	0	true
32.92404678679056	0	NULL	1	0	0	false
32.91569954365889	0	NULL	1	0	0	true
39.845454645318426	0	NULL	1	0	0	false
3.1145951928143676	0	NULL	1	0	0	false
20.494577702885913	0	NULL	1	0	0	false
19.754128235118877	0	NULL	1	0	0	true
41.39006188846539	0	NULL	1	0	0	true
5.1726951608379865	0	NULL	1	0	0	false
16.91358120533963	0	NULL	1	0	0	true
46.927050000959326	0	NULL	1	0	0	true
22.15271891090531	0	NULL	1	0	0	true
39.95053934832555	0	NULL	1	0	0	true
8.77171395741883	0	NULL	1	0	0	true
19.398344450148464	0	NULL	1	0	0	true
14.998223744245005	0	NULL	1	0	0	false
24.506909362217737	0	NULL	1	0	0	true
5.621675730832165	0	NULL	1	0	0	true
41.33606448637874	0	50	0	0	0	false
32.91569954365889	0	50	0	0	0	true
3.1145951928143676	0	50	0	0	0	false
9.589949434284112	0	60	0	0	0	true
32.92404678679056	0	60	0	0	0	false
24.506909362217737	0	60	0	0	0	true
39.845454645318426	0	70	0	0	0	false
20.494577702885913	0	70	0	0	0	false
19.398344450148464	0	70	0	0	0	true
5.1726951608379865	0	80	0	0	0	false
8.77171395741883	0	80	0	0	0	true
19.754128235118877	0	90	0	0	0	true
39.95053934832555	0	90	0	0	0	true
2.2957055987034902	0	100	0	0	0	false
41.39006188846539	0	100	0	0	0	true
46.927050000959326	0	100	0	0	0	true
22.15271891090531	0	100	0	0	0	true
14.998223744245005	0	120	0	0	0	false
5.621675730832165	0	130	0	0	0	true
16.91358120533963	0	140	0	0	0	true
2.2957055987034902	0	NULL	1	0	0	false
41.33606448637874	0	NULL	1	0	0	false
9.589949434284112	0	NULL	1	0	0	true
32.92404678679056	0	NULL	1	0	0	false
32.91569954365889	0	NULL	1	0	0	true
39.845454645318426	0	NULL	1	0	0	false
3.1145951928143676	0	NULL	1	0	0	false
20.494577702885913	0	NULL	1	0	0	false
19.754128235118877	0	NULL	1	0	0	true
41.39006188846539	0	NULL	1	0	0	true
5.1726951608379865	0	NULL	1	0	0	false
16.91358120533963	0	NULL	1	0	0	true
46.927050000959326	0	NULL	1	0	0	true
22.15271891090531	0	NULL	1	0	0	true
39.95053934832555	0	NULL	1	0	0	true
8.77171395741883	0	NULL	1	0	0	true
19.398344450148464	0	NULL	1	0	0	true
14.998223744245005	0	NULL	1	0	0	false
24.506909362217737	0	NULL	1	0	0	true
5.621675730832165	0	NULL	1	0	0	true
41.33606448637874	0	50	0	0	0	false
32.91569954365889	0	50	0	0	0	true
3.1145951928143676	0	50	0	0	0	false
9.589949434284112	0	60	0	0	0	true
32.92404678679056	0	60	0	0	0	false
24.506909362217737	0	60	0	0	0	true
39.845454645318426	0	70	0	0	0	false
20.494577702885913	0	70	0	0	0	false
19.398344450148464	0	70	0	0	0	true
5.1726951608379865	0	80	0	0	0	false
8.77171395741883	0	80	0	0	0	true
19.754128235118877	0	90	0	0	0	true
39.95053934832555	0	90	0	0	0	true
2.2957055987034902	0	100	0	0	0	false
41.39006188846539	0	100	0	0	0	true
46.927050000959326	0	100	0	0	0	true
22.15271891090531	0	100	0	0	0	true
14.998223744245005	0	120	0	0	0	false
5.621675730832165	0	130	0	0	0	true
16.91358120533963	0	140	0	0	0	true
query: select * from (select sum(int_data1) s, case when grouping(int_data2) = 1 then 'all' else cast(int_data2 as string) end b from datatest group by CUBE(int_data2) order by s union all select sum(int_data1), 'the other' from datatest group by int_data2)unio order by s
Output: file:/data/tdwadmin/testroach/QE050/qe/build/ql/tmp/312535010/10000
0	4
0	the other
1	the other
1	the other
1	8
1	9
2	2
2	3
2	7
2	the other
2	the other
2	the other
3	the other
3	0
4	1
4	5
4	the other
4	the other
19	all
query: select * from (select sum(int_data1) s , int_data2,boolean_data,double_data from datatest group by CUBE(int_data2,boolean_data),ROLLUP(double_data) having s=1 order by s union all select sum(int_data1), null,null,null from datatest group by int_data2)unio order by s
Output: file:/data/tdwadmin/testroach/QE050/qe/build/ql/tmp/341041854/10000
0	NULL	NULL	NULL
1	NULL	NULL	NULL
1	NULL	NULL	NULL
1	8	NULL	NULL
1	9	NULL	NULL
1	0	false	NULL
1	1	false	NULL
1	8	true	NULL
1	9	true	NULL
1	NULL	NULL	3.1145951928143676
1	NULL	NULL	5.621675730832165
1	NULL	NULL	16.91358120533963
1	NULL	NULL	24.506909362217737
1	NULL	NULL	32.92404678679056
1	NULL	NULL	41.39006188846539
1	NULL	NULL	46.927050000959326
1	0	NULL	3.1145951928143676
1	1	NULL	24.506909362217737
1	1	NULL	32.92404678679056
1	5	NULL	41.39006188846539
1	5	NULL	46.927050000959326
1	8	NULL	5.621675730832165
1	9	NULL	16.91358120533963
1	NULL	false	3.1145951928143676
1	NULL	false	32.92404678679056
1	NULL	true	5.621675730832165
1	NULL	true	16.91358120533963
1	NULL	true	24.506909362217737
1	NULL	true	41.39006188846539
1	NULL	true	46.927050000959326
1	0	false	3.1145951928143676
1	1	false	32.92404678679056
1	1	true	24.506909362217737
1	5	true	41.39006188846539
1	5	true	46.927050000959326
1	8	true	5.621675730832165
1	9	true	16.91358120533963
2	NULL	NULL	NULL
2	NULL	NULL	NULL
2	NULL	NULL	NULL
3	NULL	NULL	NULL
4	NULL	NULL	NULL
4	NULL	NULL	NULL
query: select count(distinct int_data1) from datatest where boolean_data = true group by rollup(boolean_data)
Output: file:/data/tdwadmin/testroach/QE050/qe/build/ql/tmp/92229371/10000
3
3
query: DROP TABLE datatest
query: 
query: 
query: 
query: 
query: 
query: 
query: 
query: 
